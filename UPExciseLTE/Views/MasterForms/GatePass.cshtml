@model UPExciseLTE.Models.GatePassDetails

@{
    ViewBag.Title = "GatePass";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script type="text/javascript">

    $(document).ready(function () {
        GatePassUploadBrandDetails();
        $("#txtDate").datepicker({

            dateFormat: "dd/mm/yy",
            changeMonth: true,
            changeYear: true
        });
        $("#txtValidTill").datepicker({

            dateFormat: "dd/mm/yy",
            changeMonth: true,
            changeYear: true
        });
        if (document.getElementById("txtDate").value.trim() != "") {
            document.getElementById("btnSave").innerHTML = "Update";
        }
    });
    
    function GatePassUploadBrandDetails() {
        var GatePassId = document.getElementById("hfGatePassId").value;
        $.ajax({
            url: '/MasterForms/GetGatePassUploadBrandDetails',
            data: { 'Gatepass': GatePassId },
            datatype: "json",
            type: "GET",
            success: function (data) {
                $('#divTable').html(data);
            },
            error: function (data) {
                alert("Error in GatePass Upload Brand Details Loading");
            }
        });
    }
    function FinalGatePass() {
        var r = confirm("Are You sure to Final GatePass?");
        if (r == true) {
            var GatePassId = document.getElementById("hfGatePassId").value;
            $.ajax({
                url: '/MasterForms/FinalGatePass',
                data: { 'Gatepass': GatePassId },
                datatype: "json",
                type: "GET",
                success: function (data) {
                    alert(data);
                    window.location.href = '../masterforms/GatePass';
                },
                error: function (data) {
                    alert("Error in GatePass Upload Brand Details Loading");
                }
            });
        }
    }
</script>
@using (Html.BeginForm("GatePass", "MasterForms", FormMethod.Post, new { @enctype = "multipart/form-data" }))
{
    @Html.AntiForgeryToken();
    @Html.ValidationSummary(true);
    <div class="page-content-inner">
        <div class="row ">
            <div class="col-md-12">
                <div class="portlet box green">
                    <div class="portlet-title">
                        <div class="caption">
                            <span>
                                <i class="fa fa-gift"></i>&nbsp;Brewery To Manufacturer Wholesale&nbsp;
                            </span>
                        </div>
                    </div>
                    @Html.HiddenFor(m => m.SP_Type)
                    @Html.HiddenFor(m => m.GatePassId, new { @id = "hfGatePassId" })
                    @Html.HiddenFor(m => m.EncGatePassId, new { @id = "hfEncGatePassId" })
                    @Html.HiddenFor(m => m.UploadValue, new { @id = "hfUploadValue" })
                    <div class="portlet-body form" style="background-color:#f5f5f5">
                        <div class="form-body">
                            <div class="row">
                                <div class="form-group  col-md-4">
                                    <label class="control-label">Gate Pass Type<b style="color:red; font-weight:800">*</b></label>
                                    @Html.DropDownListFor(m => m.GatePassType, new List<SelectListItem> { new SelectListItem { Text = "--Select--", Value = "-1" }, new SelectListItem { Text = "Inside UP", Value = "1" }, new SelectListItem { Text = "Outside UP", Value = "2" }, new SelectListItem { Text = "Outside India", Value = "3" } }, new { @id = "ddlGatePassType", @class = "form-control " })
                                </div>
                                <div class="form-group  col-md-4">
                                    <label class="control-label">From Valid Date<b style="color:red; font-weight:800">*</b></label>
                                    @Html.EditorFor(m => m.FromDate1, new { htmlAttributes = new { @id = "txtDate", @class = "form-control ", @placeholder = "Date", @required = "required" } })
                                </div>
                                <div class="form-group  col-md-4">
                                    <label class="control-label">To Till Date<b style="color:red; font-weight:800">*</b></label>
                                    @Html.EditorFor(m => m.ToDate1, new { htmlAttributes = new { @id = "txtValidTill", @class = "form-control ", @placeholder = "Valid Till", @required = "required" } })
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group  col-md-4">
                                    <label class="control-label">From License Type<b style="color:red; font-weight:800">*</b></label>
                                    @Html.DropDownListFor(m => m.FromLicenseType, (IEnumerable<SelectListItem>)ViewBag.FromLicenseTypes, new { @id = "ddlFromLicenceType", @class = "form-control" })
                                </div>
                                <div class="form-group  col-md-4">
                                    <label class="control-label">From License No<b style="color:red; font-weight:800">*</b></label>
                                    @Html.DropDownListFor(m => m.FromLicenceNo, (IEnumerable<SelectListItem>)ViewBag.FromLicenceNo, new { @id = "ddlLicenseeLicenseNo", @class = "form-control" })
                                </div>
                                <div class="form-group   col-md-4">
                                    <label class="control-label">Consignor Name<b style="color:red; font-weight:800">*</b></label>
                                    <div>
                                        @Html.TextBoxFor(m => m.FromConsignorName, new { @id = "txtConsignorName", @class = "form-control ", @placeholder = "Consignor Name", @required = "required", @readonly = "true" })
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group  col-md-4">
                                    <label class="control-label">To License Type<b style="color:red; font-weight:800">*</b></label>
                                    @Html.DropDownListFor(m => m.ToLicenseType, (IEnumerable<SelectListItem>)ViewBag.ToLicenseTypes, new { @id = "ddlToLicenceType", @class = "form-control" })
                                    @Html.DropDownList("ddlTemp", (IEnumerable<SelectListItem>)ViewBag.ToLicenseTypes, new { @id = "ddlTemp", @class = "form-control",@style= "display:none;" })
                                </div>
                                <div class="form-group  col-md-4">
                                    <label class="control-label">To License No<b style="color:red; font-weight:800">*</b></label>
                                    @Html.DropDownListFor(m => m.ToLicenceNo, (IEnumerable<SelectListItem>)ViewBag.ToLicenceNo, new { @id = "ddlLicenseeLicenseNo1", @class = "form-control" })
                                </div>
                                <div class="form-group   col-md-4">
                                    <label class="control-label">Consignee Name<b style="color:red; font-weight:800">*</b></label>
                                    <div>
                                        @Html.TextBoxFor(m => m.ToConsigeeName, new { @id = "txtConsigneeName", @class = "form-control ", @placeholder = "Consignee Name", @required = "required", @disabled = "disbled" })
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group   col-md-4">
                                    <label class="control-label">Vehicle Driver Name<b style="color:red; font-weight:800">*</b></label>
                                    <div>
                                        @Html.TextBoxFor(m => m.DriverName, new { @id = "txtVehicleDriverName", @class = "form-control ", @placeholder = "Vehicle Driver Name", @required = "required" })
                                    </div>
                                </div>

                                <div class="form-group   col-md-4">
                                    <label class="control-label">Vehicle No<b style="color:red; font-weight:800">*</b></label>
                                    <div>
                                        @Html.TextBoxFor(m => m.VehicleNo, new { @id = "txtVehicleNo", @class = "form-control ", @placeholder = "Vehicle No", @required = "required" })
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group   col-md-4">
                                    <label class="control-label">Address<b style="color:red; font-weight:800">*</b></label>
                                    <div>
                                        @Html.TextAreaFor(m => m.Address, new { @id = "txtAddress", @class = "form-control ", @placeholder = "Address", @required = "required" })
                                    </div>
                                </div>
                                <div class="form-group   col-md-4">
                                    <label class="control-label">Route Details<b style="color:red; font-weight:800">*</b></label>
                                    <div>
                                        @Html.TextAreaFor(m => m.RouteDetails, new { @id = "txtAreaRouteDetails", @class = "form-control ", @placeholder = "Route Details", @required = "required" })
                                    </div>
                                </div>
                                <div class="form-group   col-md-4">
                                    <label class="control-label">Vehicle Agency Name And Address<b style="color:red; font-weight:800">*</b></label>
                                    <div>
                                        @Html.TextAreaFor(m => m.AgencyNameAndAddress, new { @id = "txtAreaVehicleAgencyNameAndAddress", @class = "form-control ", @placeholder = "Vehicle Agency Name And Address", @required = "required" })
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group  ">
                                    <div class="col-md-12">
                                        <label class="control-label">Major Districts in Route<b style="color:red; font-weight:800">*</b></label>
                                    </div>

                                    <div class="col-md-4 ">
                                        @Html.DropDownListFor(m => m.district_code_census1, (IEnumerable<SelectListItem>)ViewBag.Districts, new { @id = "MDistrictId1", @class = "form-control col-md-4" })

                                    </div>
                                    <div class="col-md-4 ">
                                        @Html.DropDownListFor(m => m.district_code_census2, (IEnumerable<SelectListItem>)ViewBag.Districts, new { @id = "MDistrictId2", @class = "form-control col-md-4" })

                                    </div>
                                    <div class="col-md-4 ">
                                        @Html.DropDownListFor(m => m.district_code_census3, (IEnumerable<SelectListItem>)ViewBag.Districts, new { @id = "MDistrictId3", @class = "form-control col-md-4" })
                                    </div>

                                </div>
                            </div>
                            <div class="row">
                                <br />
                                <div class="form-group   col-md-4">
                                    <label class="control-label">Gross Weight<b style="color:red; font-weight:800">*</b></label>
                                    <div>
                                        @Html.TextBoxFor(m => m.GrossWeight, new { @id = "txtGrossWeight", @class = "form-control ", @placeholder = "Gross Weight", @required = "required", @onkeypress = "return isfloatNumber(this, event);", @onChange = "Sum(); " })

                                    </div>
                                </div>
                                <div class="form-group   col-md-4">
                                    <label class="control-label">Tare Weight<b style="color:red; font-weight:800">*</b></label>
                                    <div>
                                        @Html.TextBoxFor(m => m.TareWeight, new { @id = "txtTareWeight", @class = "form-control ", @placeholder = "Tare Weight", @required = "required", @onkeypress = "return isfloatNumber(this, event);", @onChange = "Sum();" })

                                    </div>
                                </div>
                                <div class="form-group   col-md-4">
                                    <label class="control-label">Net Weight</label>
                                    <div>
                                        @Html.TextBoxFor(m => m.NetWeight, new { @id = "txtNetWeight", @class = "form-control ", @placeholder = "Net Weight", @required = "required", @disabled = "disbled" })

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div style="clear:both"></div>
                        <center>
                            <div class="form-actions">
                                <button type="submit" class="btn green" id="btnSave">Save</button>
                                <button type="button" class="btn default" style="background-color: #659be0;color:white;border-color:#8E44AD" id="btnUploadCSV" onclick="window.location.href = '../masterforms/UploadGAtePassCSV?A=' + document.getElementById('hfGatePassId').value + '&B=' + document.getElementById('hfUploadValue').value ">Upload CSV</button>
                                <button type="button" class="btn danger" style="background-color:crimson; color:white" id="btnFinal" onclick="FinalGatePass();">Final Gatepass</button>
                            </div>
                        </center>
                        <div class="form-body">
                            <div id="divTable"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
<script type="text/javascript">
    $('#ddlGatePassType').change(function () {
        var GatePassType = $('#ddlGatePassType').val();
        if (GatePassType == 1) {
            $('#ddlToLicenceType').html($('#ddlTemp').html());
            $("#ddlToLicenceType option[value='40']").remove();
            $("#ddlToLicenceType option[value='41']").remove();
        }
        else if (GatePassType == 2) {
            $('#ddlToLicenceType').html($('#ddlTemp').html());
            $("#ddlToLicenceType option[value='-1']").remove();
            $("#ddlToLicenceType option[value='1']").remove();
            $("#ddlToLicenceType option[value='55']").remove();
            $("#ddlToLicenceType option[value='41']").remove();
        }
        else if (GatePassType == 3) {
            $('#ddlToLicenceType').html($('#ddlTemp').html());
            $("#ddlToLicenceType option[value='-1']").remove();
            $("#ddlToLicenceType option[value='1']").remove();
            $("#ddlToLicenceType option[value='55']").remove();
            $("#ddlToLicenceType option[value='40']").remove();
        }

    })
    $("#ddlLicenseeLicenseNo1").change(function () {
        $("#txtConsigneeName").val(this.value);
    });
    $("#ddlLicenseeLicenseNo").change(function () {
        $("#txtConsignorName").val(this.value);
    });
    $("#MDistrictId1").change(function () {
        if ($("#MDistrictId1").val() != "-1") {
            $('#MDistrictId2').html($('#MDistrictId1').html());
            $("#MDistrictId2 option[value='" + $("#MDistrictId1").val() + "']").remove();
            $("#MDistrictId2").val() = "-1"
            $("#MDistrictId3").val() = "-1"
        }
    })
    $("#MDistrictId2").change(function () {
        if ($("#MDistrictId2").val() != "-1") {
            $('#MDistrictId3').html($('#MDistrictId2').html());
            $("#MDistrictId3 option[value='" + $("#MDistrictId2").val() + "']").remove();
            $("#MDistrictId3").val() = "-1"

        }
    })
    function Sum() {
        var grossweight = parseFloat($("#txtGrossWeight").val());
        var tareweight = parseFloat($("#txtTareWeight").val());
        var netweight = (grossweight - tareweight);
        $("#txtNetWeight").val(netweight);
    }
</script>