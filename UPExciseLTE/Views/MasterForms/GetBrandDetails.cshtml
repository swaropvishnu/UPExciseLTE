@model IEnumerable<UPExciseLTE.Models.BrandMaster>

@{
    ViewBag.Title = "Edit/Delete Brand";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@using (Html.BeginForm("GetBrandDetails", "MasterForms", FormMethod.Post, new { @enctype = "multipart/form-data", id = "__AjaxAntiForgeryForm" }))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)
    <div class="page-content-inner">
        <div class="row ">
            <div class="col-md-12">
                <div class="portlet box green">
                    <div class="portlet-title">
                        <div class="caption">
                            <i class="fa fa-gift"></i>Edit/Delete Brand
                        </div>
                    </div>
                    <div class="portlet-body form" style="background-color: #f5f5f5">
                        <div style="display:none">
                            <div class="form-body">
                                <div class="form-group col-md-4">
                                    <label class="control-label">State</label>
                                    <div>
                                        @Html.DropDownList("ddlState",(IEnumerable<SelectListItem>)ViewBag.StateList, new { @id = "ddlState", @class = "form-control" })
                                    </div>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="control-label">Licence Type</label>
                                    <div>
                                        @Html.DropDownList("ddlLicenseType", new List<SelectListItem> { new SelectListItem { Text = "-All-", Value = "" }, new SelectListItem { Text = "FL3", Value = "FL3" }, new SelectListItem { Text = "FL3A", Value = "FL3A" } }, new { @id = "ddlLicense", @class = "form-control" })
                                    </div>
                                </div>
                                <div class="form-group col-md-4">
                                    <label class="control-label">Licence Number</label>
                                    @Html.TextBox("txtLicenseNo", "", new { @id = "txtLicenseNo", @class = "form-control", @Value = "" })
                                </div>
                                @*<div class="form-group col-md-4">
                    <label class="control-label">Brewery</label>
                    @Html.DropDownList("ddlBrewery", (IEnumerable<SelectListItem>)ViewBag.Brewery, new { @id = "ddlBrewery", @class = "form-control", @readonly = true })
                </div>

                <div class="form-group col-md-4">
                    <label class="control-label">District</label>
                    @Html.DropDownList("ddlDistrict", (IEnumerable<SelectListItem>)ViewBag.District, new { @id = "ddlDistrict", @class = "form-control" })
                </div>
                <div class="form-group col-md-4">
                    <label class="control-label">Tehsil</label>
                    @Html.DropDownList("ddlTehsil", (IEnumerable<SelectListItem>)ViewBag.Tehsil, new { @id = "ddlTehsil", @class = "form-control" })
                </div>*@
                            </div>
                            <div class="clearfix"></div>
                            <center>
                                <div class="form-actions">
                                    <button type="submit" class="btn green">Search</button>

                                    <button type="button" class="btn default" style="background-color: #659be0;color:white;border-color:#8E44AD" onclick="BrandMaster();">Go To Brand Entry</button>
                                    <button type="button" class="btn danger" style="background-color:crimson; color:white">Reset</button>
                                </div>
                            </center>
                        </div>
                        <table class="table table-striped table-bordered table-hover">
                            <tr>

                                @*<th>
            @Html.DisplayNameFor(model => model.BrandId)
        </th>*@
                                <th>
                                    @Html.DisplayNameFor(model => model.BrandName)
                                </th>
                                <th>
                                    @*@Html.DisplayNameFor(model => model.BrandRegistrationNumber)*@
                                    Brand Reg No
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.Strength)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.LiquorType)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.LicenceType)
                                </th>
                                @if (UserSession.LoggedInUserLevelId.Trim() == "25")
                                {
                                <th>
                                    Box-Size (Number of Bottles / Pet)
                                </th>
                                }
                                else
                                {
                                    <th>
                                        @Html.DisplayNameFor(model => model.QuantityInCase)
                                    </th>
                                }
                                @if (UserSession.LoggedInUserLevelId.Trim() == "25")
                                {
                                    <th>Capacity of Bottle/ Pet (in ml.)</th>
                                }
                                else
                                {
                                    <th>
                                        @Html.DisplayNameFor(model => model.QuantityInBottleML)
                                    </th>
                                }
                                <th>
                                    @Html.DisplayNameFor(model => model.XFactoryPrice)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.ExciseDuty)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.MRP)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.Status)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.Reason)
                                </th>
                                <th></th>
                                <th></th>
                            </tr>
                            @foreach (var item in Model)
                            {
                                <tr>

                                    @*<td>
                                        @Html.DisplayFor(modelItem => item.BrandId)
                                    </td>*@

                                    <td>
                                        @Html.DisplayFor(modelItem => item.BrandName)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.BrandRegistrationNumber)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Strength)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.LiquorType)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.LicenceType)
                                    </td>
                                  
                                    
                                    <td>
                                        @Html.DisplayFor(modelItem => item.QuantityInCase)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.QuantityInBottleML)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.XFactoryPrice)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.ExciseDuty)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.MRP)
                                    </td>
                                    <td>
                                        @if (item.BrandStatus == "P")
                                        {
                                            @Html.DisplayFor(modelItem => item.Status)
                                        }
                                        else
                                        {
                                        <span style="color:red;font-size: 15px;font-weight: 700;"> @Html.DisplayFor(modelItem => item.Status) </span>
                                        }
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Reason)
                                    </td>
                                    <td>
                                        @if (item.BrandStatus == "P")
                                        {
                                            <a href="@Url.Action("BrandMaster", "MasterForms", new { Code = item.brandID_incrpt })"><label class="btn blue">Edit</label></a>
                                        }
                                        else
                                        {
                                            <a href="@Url.Action("BrandMaster","MasterForms", new {Code = item.brandID_incrpt })"><label class="btn blue">View</label></a>
                                        }
                                    </td>
                                    <td>
                                        @if (item.BrandStatus == "P")
                                        {
                                            <button type="button" class="btn danger" style="background-color:crimson; color:white" onclick="FinalBrand('@item.BrandId')">Delete</button>
                                        }
                                        @*@Html.ActionLink("Edit", "BrandMaster", new { id = item.BrandId })*@
                                    </td>
                                </tr>
                            }
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        var form = $('#__AjaxAntiForgeryForm');
        var token = $('input[name="__RequestVerificationToken"]', form).val();

    function BrandMaster() {
        var url = '@Url.Action("BrandMaster", "MasterForms", null)';
        window.location.href = url;
    }
    function FinalBrand(BrandId) {
        $.ajax({
            url: '/MasterForms/DeleteBrand',
            data: { 'BrandId': BrandId, __RequestVerificationToken: token  },
            //datatype: "json",
            type: "POST",
            success: function (data) {
                alert(data);
                window.location = "../MasterForms/GetBrandDetails";
            },
            error: function (data) {
                alert("Error in final brand Loading");
            }
        });
    }
    </script>
}


